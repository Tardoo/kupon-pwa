<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Futbol Kupon Oyunu</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1d2a">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      padding: 15px;
    }

    h2 {
      text-align: center;
    }

    .card {
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #zeppelin {
      background: #0b1d2a;
      color: #fff;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
    }

    button {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }

    .start { background: #2ecc71; }
    .cashout { background: #e67e22; }
    #crashCanvas {
  background: #0b1d2a;
  border-radius: 8px;
  display: block;
  margin: 10px auto;
}

  </style>
</head>

<body>

<h2>âš½ Futbol Kupon Oyunu</h2>

<div class="card">
  <p><strong>Oyun ParasÄ±:</strong> <span id="coin">1000</span> COIN</p>
  <p>Kupon KazancÄ±: <span id="couponWin">0</span> COIN</p>
  <button onclick="finishCoupon()">Kuponu Bitir (+100 COIN)</button>
</div>

<h2>ðŸŽˆ Zeplin Mini Oyunu</h2>

<div id="zeppelin" class="card">
  <p>Bahis (COIN)</p>
  <input type="number" id="bet" value="50" min="10">

  <canvas id="crashCanvas" width="300" height="200"></canvas>

  <h3><span id="multiplier">1.00x</span></h3>

  <button class="start" onclick="startGame()">BaÅŸlat</button>
  <button class="cashout" onclick="cashOut()">Ã‡ek</button>

  <p id="status">HazÄ±r</p>
</div>

<!-- SESLER -->
<audio id="startSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="cashSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="crashSound" src="https://actions.google.com/sounds/v1/explosions/explosion.ogg"></audio>

<script>
/* ===== COIN SÄ°STEMÄ° ===== */
let coin = Number(localStorage.getItem("coin")) || 1000;
let couponWin = 0;

function updateCoin() {
  document.getElementById("coin").innerText = coin;
  localStorage.setItem("coin", coin);
}

/* ===== KUPON ===== */
function finishCoupon() {
  couponWin = 100;
  coin += couponWin;
  document.getElementById("couponWin").innerText = couponWin;
  updateCoin();
}

/* ===== ZEP LÄ°N (CRASH) ===== */
const canvas = document.getElementById("crashCanvas");
const ctx = canvas.getContext("2d");

let coin = Number(localStorage.getItem("coin")) || 1000;
document.getElementById("coin").innerText = coin;

let multiplier = 1;
let crashPoint = 0;
let betAmount = 0;
let playing = false;
let interval = null;

let x = 20;
let y = canvas.height - 20;

// Sesler
const startSound = document.getElementById("startSound");
const cashSound = document.getElementById("cashSound");
const crashSound = document.getElementById("crashSound");

function updateCoin() {
  document.getElementById("coin").innerText = coin;
  localStorage.setItem("coin", coin);
}

function drawGraph() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Ã§izgi
  ctx.strokeStyle = "#2ecc71";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(20, canvas.height - 20);
  ctx.lineTo(x, y);
  ctx.stroke();

  // zeplin
  ctx.font = "20px Arial";
  ctx.fillText("ðŸŽˆ", x - 10, y - 10);
}

function startGame() {
  if (playing) return;

  betAmount = Number(document.getElementById("bet").value);
  if (betAmount > coin) {
    alert("Yetersiz COIN");
    return;
  }

  startSound.play();

  coin -= betAmount;
  updateCoin();

  multiplier = 1;
  crashPoint = Math.random() * 4 + 1.5;
  playing = true;

  x = 20;
  y = canvas.height - 20;

  document.getElementById("status").innerText = "Zeplin yÃ¼kseliyor ðŸŽˆ";

  interval = setInterval(() => {
    multiplier += 0.02;
    x += 2;
    y -= 1.5;

    document.getElementById("multiplier").innerText =
      multiplier.toFixed(2) + "x";

    drawGraph();

    if (multiplier >= crashPoint || y <= 20) {
      crash();
    }
  }, 100);
}

function cashOut() {
  if (!playing) return;

  clearInterval(interval);
  cashSound.play();

  const win = Math.floor(betAmount * multiplier);
  coin += win;
  updateCoin();

  document.getElementById("status").innerText =
    "ðŸŽ‰ KazandÄ±n +" + win + " COIN";

  playing = false;
}

function crash() {
  clearInterval(interval);
  crashSound.play();

  ctx.font = "30px Arial";
  ctx.fillText("ðŸ’¥", x - 15, y - 10);

  document.getElementById("status").innerText =
    "ðŸ’¥ Zeplin patladÄ±!";

  playing = false;
}

updateCoin();

/* ===== SERVICE WORKER ===== */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>

</body>
</html>
